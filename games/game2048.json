{
  "id": "game2048",
  "name": "2048",
  "description": "숫자 합치기 퍼즐 게임",
  "version": "1.0.0",
  "iconUrl": "https://example.com/icons/2048.png",
  "fileSize": 0,
  "isBuiltIn": false,
  "categories": ["퍼즐", "전략"],
  "lastUpdated": "2024-01-15T00:00:00Z",
  "gameType": "game2048",
  "config": {
    "gridSize": 4
  },
  "dartCode": "import 'package:flutter/material.dart';\nimport 'dart:math';\n\nclass Game2048 extends StatefulWidget {\n  const Game2048({super.key});\n\n  @override\n  State<Game2048> createState() => _Game2048State();\n}\n\nclass _Game2048State extends State<Game2048> {\n  List<List<int>> grid = List.generate(4, (_) => List.filled(4, 0));\n  int score = 0;\n  int bestScore = 0;\n  bool isGameOver = false;\n  bool hasWon = false;\n  final Random random = Random();\n\n  @override\n  void initState() {\n    super.initState();\n    _loadBestScore();\n    _resetGame();\n  }\n\n  void _loadBestScore() {\n    // 실제로는 SharedPreferences 사용\n    bestScore = 0;\n  }\n\n  void _resetGame() {\n    setState(() {\n      grid = List.generate(4, (_) => List.filled(4, 0));\n      score = 0;\n      isGameOver = false;\n      hasWon = false;\n    });\n    _addRandomTile();\n    _addRandomTile();\n  }\n\n  void _addRandomTile() {\n    List<Point<int>> emptyCells = [];\n    for (int i = 0; i < 4; i++) {\n      for (int j = 0; j < 4; j++) {\n        if (grid[i][j] == 0) {\n          emptyCells.add(Point(i, j));\n        }\n      }\n    }\n    if (emptyCells.isNotEmpty) {\n      final cell = emptyCells[random.nextInt(emptyCells.length)];\n      grid[cell.x][cell.y] = random.nextDouble() < 0.9 ? 2 : 4;\n    }\n  }\n\n  bool _canMove() {\n    for (int i = 0; i < 4; i++) {\n      for (int j = 0; j < 4; j++) {\n        if (grid[i][j] == 0) return true;\n        if (i < 3 && grid[i][j] == grid[i + 1][j]) return true;\n        if (j < 3 && grid[i][j] == grid[i][j + 1]) return true;\n      }\n    }\n    return false;\n  }\n\n  void _checkGameOver() {\n    if (!_canMove()) {\n      setState(() {\n        isGameOver = true;\n      });\n      if (score > bestScore) {\n        bestScore = score;\n      }\n    }\n  }\n\n  void _checkWin() {\n    if (!hasWon) {\n      for (int i = 0; i < 4; i++) {\n        for (int j = 0; j < 4; j++) {\n          if (grid[i][j] == 2048) {\n            setState(() {\n              hasWon = true;\n            });\n            showDialog(\n              context: context,\n              builder: (context) => AlertDialog(\n                title: const Text('축하합니다!'),\n                content: const Text('2048을 달성했습니다!'),\n                actions: [\n                  TextButton(\n                    onPressed: () {\n                      Navigator.pop(context);\n                      setState(() {\n                        hasWon = false;\n                      });\n                    },\n                    child: const Text('계속하기'),\n                  ),\n                ],\n              ),\n            );\n            return;\n          }\n        }\n      }\n    }\n  }\n\n  List<int> _merge(List<int> line) {\n    List<int> merged = [];\n    bool canMerge = true;\n    for (int i = 0; i < line.length; i++) {\n      if (line[i] != 0) {\n        if (merged.isNotEmpty && merged.last == line[i] && canMerge) {\n          merged[merged.length - 1] *= 2;\n          score += merged.last;\n          canMerge = false;\n        } else {\n          merged.add(line[i]);\n          canMerge = true;\n        }\n      }\n    }\n    while (merged.length < 4) {\n      merged.add(0);\n    }\n    return merged;\n  }\n\n  void _moveLeft() {\n    bool moved = false;\n    for (int i = 0; i < 4; i++) {\n      List<int> line = grid[i].toList();\n      List<int> merged = _merge(line);\n      if (line.toString() != merged.toString()) {\n        grid[i] = merged;\n        moved = true;\n      }\n    }\n    if (moved) {\n      _addRandomTile();\n      _checkWin();\n      _checkGameOver();\n    }\n  }\n\n  void _moveRight() {\n    bool moved = false;\n    for (int i = 0; i < 4; i++) {\n      List<int> line = grid[i].reversed.toList();\n      List<int> merged = _merge(line).reversed.toList();\n      if (line.toString() != merged.toString()) {\n        grid[i] = merged;\n        moved = true;\n      }\n    }\n    if (moved) {\n      _addRandomTile();\n      _checkWin();\n      _checkGameOver();\n    }\n  }\n\n  void _moveUp() {\n    bool moved = false;\n    for (int j = 0; j < 4; j++) {\n      List<int> line = [];\n      for (int i = 0; i < 4; i++) {\n        line.add(grid[i][j]);\n      }\n      List<int> merged = _merge(line);\n      if (line.toString() != merged.toString()) {\n        for (int i = 0; i < 4; i++) {\n          grid[i][j] = merged[i];\n        }\n        moved = true;\n      }\n    }\n    if (moved) {\n      _addRandomTile();\n      _checkWin();\n      _checkGameOver();\n    }\n  }\n\n  void _moveDown() {\n    bool moved = false;\n    for (int j = 0; j < 4; j++) {\n      List<int> line = [];\n      for (int i = 3; i >= 0; i--) {\n        line.add(grid[i][j]);\n      }\n      List<int> merged = _merge(line).reversed.toList();\n      if (line.toString() != merged.toString()) {\n        for (int i = 0; i < 4; i++) {\n          grid[i][j] = merged[i];\n        }\n        moved = true;\n      }\n    }\n    if (moved) {\n      _addRandomTile();\n      _checkWin();\n      _checkGameOver();\n    }\n  }\n\n  Color _getTileColor(int value) {\n    if (value == 0) return Colors.grey[300]!;\n    final colors = {\n      2: Colors.grey[100],\n      4: Colors.grey[200],\n      8: Colors.orange[200],\n      16: Colors.orange[300],\n      32: Colors.orange[400],\n      64: Colors.orange[500],\n      128: Colors.yellow[300],\n      256: Colors.yellow[400],\n      512: Colors.yellow[500],\n      1024: Colors.yellow[600],\n      2048: Colors.red[400],\n    };\n    return colors[value] ?? Colors.purple;\n  }\n\n  Color _getTextColor(int value) {\n    return value <= 4 ? Colors.black87 : Colors.white;\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(title: const Text('2048')),\n      body: Column(\n        children: [\n          Padding(\n            padding: const EdgeInsets.all(16),\n            child: Row(\n              mainAxisAlignment: MainAxisAlignment.spaceAround,\n              children: [\n                Column(\n                  children: [\n                    const Text('점수', style: TextStyle(fontSize: 14)),\n                    Text('$score', style: const TextStyle(fontSize: 20, fontWeight: FontWeight.bold)),\n                  ],\n                ),\n                Column(\n                  children: [\n                    const Text('최고 점수', style: TextStyle(fontSize: 14)),\n                    Text('$bestScore', style: const TextStyle(fontSize: 20, fontWeight: FontWeight.bold)),\n                  ],\n                ),\n                ElevatedButton(\n                  onPressed: _resetGame,\n                  child: const Text('새 게임'),\n                ),\n              ],\n            ),\n          ),\n          Expanded(\n            child: Center(\n              child: AspectRatio(\n                aspectRatio: 1,\n                child: Container(\n                  margin: const EdgeInsets.all(16),\n                  padding: const EdgeInsets.all(8),\n                  decoration: BoxDecoration(\n                    color: Colors.grey[300],\n                    borderRadius: BorderRadius.circular(8),\n                  ),\n                  child: GridView.builder(\n                    physics: const NeverScrollableScrollPhysics(),\n                    gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(\n                      crossAxisCount: 4,\n                      crossAxisSpacing: 8,\n                      mainAxisSpacing: 8,\n                    ),\n                    itemCount: 16,\n                    itemBuilder: (context, index) {\n                      int row = index ~/ 4;\n                      int col = index % 4;\n                      int value = grid[row][col];\n                      return Container(\n                        decoration: BoxDecoration(\n                          color: _getTileColor(value),\n                          borderRadius: BorderRadius.circular(4),\n                        ),\n                        child: Center(\n                          child: Text(\n                            value == 0 ? '' : value.toString(),\n                            style: TextStyle(\n                              fontSize: value < 100 ? 24 : value < 1000 ? 20 : 16,\n                              fontWeight: FontWeight.bold,\n                              color: _getTextColor(value),\n                            ),\n                          ),\n                        ),\n                      );\n                    },\n                  ),\n                ),\n              ),\n            ),\n          ),\n          if (isGameOver)\n            Padding(\n              padding: const EdgeInsets.all(16),\n              child: Column(\n                children: [\n                  const Text(\n                    '게임 오버!',\n                    style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold, color: Colors.red),\n                  ),\n                  const SizedBox(height: 8),\n                  ElevatedButton(\n                    onPressed: _resetGame,\n                    child: const Text('다시 시작'),\n                  ),\n                ],\n              ),\n            ),\n          Padding(\n            padding: const EdgeInsets.all(16),\n            child: Column(\n              children: [\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    IconButton(\n                      icon: const Icon(Icons.arrow_upward),\n                      onPressed: isGameOver ? null : _moveUp,\n                    ),\n                  ],\n                ),\n                Row(\n                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,\n                  children: [\n                    IconButton(\n                      icon: const Icon(Icons.arrow_back),\n                      onPressed: isGameOver ? null : _moveLeft,\n                    ),\n                    IconButton(\n                      icon: const Icon(Icons.arrow_downward),\n                      onPressed: isGameOver ? null : _moveDown,\n                    ),\n                    IconButton(\n                      icon: const Icon(Icons.arrow_forward),\n                      onPressed: isGameOver ? null : _moveRight,\n                    ),\n                  ],\n                ),\n              ],\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n}\n"
}

